# 第七次作业

## 7.7
将除开s和t之外的每一个点v拆分成v1,v2，对于原来任意一条边$(u_i,v_i,f_i)$，在新图中建边 $(u_{i2},v_{i1},f_i)$，同时对于点v自有的流量限制 $c(v)$，建边 $(v_1,v_2,c(v))$。具体定义新图如下：

$$\begin{aligned}
V'&=\{s,t\}\bigcup\{v_1,v_2 | \forall v \in V, v \neq s,v\neq t\}\\
E'&=\{(u_{i2},v_{i1}) | \forall (u,v) \in E\} \bigcup \{(v_1,v_2)| \forall v \in V,v\neq s, v\neq t\}\\
C'&=\{c(u,v)|(u,v)\in C\}\bigcup \{c(v)|v\in V,v\neq s,v\neq t\}\\
N'&=\{V',E',C',s,t\}
\end{aligned}$$

这样原图中的任意合法流均可以转化为新图中的合法流，反过来也成立。所以得到的新图中的传统最大流就是原图的带点限制的最大流

## 7.9
设原有向图为 $< V,E >$，建立最大流模型如下：

$$\begin{aligned}
V'&=V\\
E'&=E\\
C'&=\{1|(u,v)\in E\}\\
N'&=\{V',E',C',s,t\}
\end{aligned}$$

下面证明新图上的最大流就是原图的最多边不相交的路径。证明思路是原图中任意一种边不相交的路径方案均对应的是新图中的一个可行流。  
考虑在 N' 上的任意一个可行流，将剩余流量为 0 的边以及相关的点提取出来建立子图 G，由可行流的性质可知，G中除s和t外的每一个点的入度和出度相等，那么每次从s出发寻找一条到t的边不重复路径，在 G 中删除这一条路径，剩下的图依然满足度数的条件；重复上述过程直到 G 中不存在任意一条边，即可得到原图中一种边不相交的路径方案。  
考虑在原图中，一个边不相交的路径方案，对于每一条路径，对应 N' 中的一条从 s 到 t 的增广路。由于这里路径的边并不相交，所以这些增广路也不相交，故就能对应 N' 中的一个可行流。  
这样我们就证明了可行流与路径方案等价，那么最大流就与最多路径的方案等价。

时间复杂度分析：  
对于 FF 算法，由于 N' 中每一条边的流量均为 1，所以时间复杂度为 $O(nm)$  
对于 Dinic 算法，其时间复杂度为 $n\sqrt n m$

## 7.10
设原图为 $< V,E >$，将除 s,t 外每一个点v拆分成两个点 v1,v2，构造如下新图

$$\begin{aligned}
V'&=\{s,t\}\bigcup\{v_1,v_2 | v \in V - \{s,t\}\} \\
E'&=E \bigcup \{(v_1,v_2)|v\in V\}\\
C'&=\{1|e\in E'\}\\
N'&=\{V',E',C',s,t\}
\end{aligned}$$

类似7.9中的证明，可以讲新图中的任意可行流与原图中点不相交的路径等价。值得注意的是，与上一题不同的是，每一个点只能使用一次比每条边只能使用一次的条件更强，即每个点仅使用一次蕴含着每条边只使用一次。故最大流就对应原图中点不重复的最多路径。  
时间复杂度分析：  
对于 FF 算法，由于 N' 中每一条边流量均为 1，所以时间复杂度为 $O(n(n+m))$  
对于 Dinic 算法，其时间复杂度为 $n\sqrt n m$

## 7.16
证：
取任意一个最大流，我们证明能通过这样任意找到的最大流调整出满足题设条件的最大流。若此时已经满足 s 无入流量，t 无出流量，则已经找到。否则，不妨设是 s 存在入流量，从 s 的入流量倒着查找，由最大流定义，可知一定能够追溯到源点 s，这样找到一个环流，同时我们可以使得找到的环流中除 s 以外没有重复的点，在最大流中删除这个环流，由定义知这不会影响最大流的性质。  
由于每次删除一个环流会使得 s 的入流量严格减少，所以重复上述过程一定可以在有限步内让 s 的入流量减少到 0 。同理，对于 t 的出流量也做同样的操作，注意到此时 s 的入流量已经为 0 了，所以在处理 t 的时候不会影响到已经处理完的 s。  
经过上述操作，就可以将任意最大流调整为 s 无入流量、t 无出流量的一个最大流。

## 7.21(1)
将每一个点拆分成两个，然后按照下面方式建图

![1](_v_images/20220425214649562_21153.jpg =460x)

其中每一条边上的信息$(flow,w)$表示容量为 flow，花费为 w。